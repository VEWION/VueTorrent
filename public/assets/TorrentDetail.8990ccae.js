import{m as L,V as I}from"./vue.10642814.js";import{L as w,ay as V,bm as Q,b as r,y as h,bn as Y,b9 as J,al as X,U as Z,bo as ee,e as A,bf as te,Q as d,s as v,t as m,A as b,B as T,a8 as O,a1 as S,a2 as D,a3 as $,a4 as P,bp as se,l as ie,$ as ne,bq as ae,a7 as re,bd as oe,r as B,br as le,a as de,x as _,aY as ce,a0 as he,aA as _e,aB as pe,aC as ue,aD as me,bs as F,bt as ve,bu as fe,z as k,E as x,V as ge,D as Ce,bv as Te,bw as ye,f as be}from"./index.97333b8d.js";import{F as C}from"./FullScreenModal.cd9b8d19.js";import{B as y,_ as Se,d as $e,a as f,b as ke,c as g}from"./VTabItem.b8eed633.js";import{_ as j,a as xe}from"./VDataTable.3358125d.js";import{_ as we}from"./VDialog.3648e482.js";import{_ as Ie}from"./VCheckbox.9aed5a6c.js";import{_ as Ae}from"./VTextarea.cc529afa.js";import"./index.151f8f28.js";const E=w(y,V).extend({name:"v-list-item-group",provide(){return{isInGroup:!0,listItemGroup:this}},computed:{classes(){return{...y.options.computed.classes.call(this),"v-list-item-group":!0}}},methods:{genData(){return this.setTextColor(this.color,{...y.options.methods.genData.call(this),attrs:{role:"listbox"}})}}});const Oe=w(V,Q("treeview")),K={activatable:Boolean,activeClass:{type:String,default:"v-treeview-node--active"},color:{type:String,default:"primary"},disablePerNode:Boolean,expandIcon:{type:String,default:"$subgroup"},indeterminateIcon:{type:String,default:"$checkboxIndeterminate"},itemChildren:{type:String,default:"children"},itemDisabled:{type:String,default:"disabled"},itemKey:{type:String,default:"id"},itemText:{type:String,default:"name"},loadChildren:Function,loadingIcon:{type:String,default:"$loading"},offIcon:{type:String,default:"$checkboxOff"},onIcon:{type:String,default:"$checkboxOn"},openOnClick:Boolean,rounded:Boolean,selectable:Boolean,selectedColor:{type:String,default:"accent"},shaped:Boolean,transition:Boolean,selectionType:{type:String,default:"leaf",validator:s=>["leaf","independent"].includes(s)}},U=Oe.extend().extend({name:"v-treeview-node",inject:{treeview:{default:null}},props:{level:Number,item:{type:Object,default:()=>null},parentIsDisabled:Boolean,...K},data:()=>({hasLoaded:!1,isActive:!1,isIndeterminate:!1,isLoading:!1,isOpen:!1,isSelected:!1}),computed:{disabled(){return r(this.item,this.itemDisabled)||!this.disablePerNode&&this.parentIsDisabled&&this.selectionType==="leaf"},key(){return r(this.item,this.itemKey)},children(){const s=r(this.item,this.itemChildren);return s&&s.filter(e=>!this.treeview.isExcluded(r(e,this.itemKey)))},text(){return r(this.item,this.itemText)},scopedProps(){return{item:this.item,leaf:!this.children,selected:this.isSelected,indeterminate:this.isIndeterminate,active:this.isActive,open:this.isOpen}},computedIcon(){return this.isIndeterminate?this.indeterminateIcon:this.isSelected?this.onIcon:this.offIcon},hasChildren(){return!!this.children&&(!!this.children.length||!!this.loadChildren)}},created(){this.treeview.register(this)},beforeDestroy(){this.treeview.unregister(this)},methods:{checkChildren(){return new Promise(s=>{if(!this.children||this.children.length||!this.loadChildren||this.hasLoaded)return s();this.isLoading=!0,s(this.loadChildren(this.item))}).then(()=>{this.isLoading=!1,this.hasLoaded=!0})},open(){this.isOpen=!this.isOpen,this.treeview.updateOpen(this.key,this.isOpen),this.treeview.emitOpen()},genLabel(){const s=[];return this.$scopedSlots.label?s.push(this.$scopedSlots.label(this.scopedProps)):s.push(this.text),this.$createElement("div",{slot:"label",staticClass:"v-treeview-node__label"},s)},genPrependSlot(){return this.$scopedSlots.prepend?this.$createElement("div",{staticClass:"v-treeview-node__prepend"},this.$scopedSlots.prepend(this.scopedProps)):null},genAppendSlot(){return this.$scopedSlots.append?this.$createElement("div",{staticClass:"v-treeview-node__append"},this.$scopedSlots.append(this.scopedProps)):null},genContent(){const s=[this.genPrependSlot(),this.genLabel(),this.genAppendSlot()];return this.$createElement("div",{staticClass:"v-treeview-node__content"},s)},genToggle(){return this.$createElement(h,{staticClass:"v-treeview-node__toggle",class:{"v-treeview-node__toggle--open":this.isOpen,"v-treeview-node__toggle--loading":this.isLoading},slot:"prepend",on:{click:s=>{s.stopPropagation(),!this.isLoading&&this.checkChildren().then(()=>this.open())}}},[this.isLoading?this.loadingIcon:this.expandIcon])},genCheckbox(){return this.$createElement(h,{staticClass:"v-treeview-node__checkbox",props:{color:this.isSelected||this.isIndeterminate?this.selectedColor:void 0,disabled:this.disabled},on:{click:s=>{s.stopPropagation(),!this.isLoading&&this.checkChildren().then(()=>{this.$nextTick(()=>{this.isSelected=!this.isSelected,this.isIndeterminate=!1,this.treeview.updateSelected(this.key,this.isSelected),this.treeview.emitSelected()})})}}},[this.computedIcon])},genLevel(s){return Y(s).map(()=>this.$createElement("div",{staticClass:"v-treeview-node__level"}))},genNode(){const s=[this.genContent()];return this.selectable&&s.unshift(this.genCheckbox()),this.hasChildren?s.unshift(this.genToggle()):s.unshift(...this.genLevel(1)),s.unshift(...this.genLevel(this.level)),this.$createElement("div",this.setTextColor(this.isActive&&this.color,{staticClass:"v-treeview-node__root",class:{[this.activeClass]:this.isActive},on:{click:()=>{this.openOnClick&&this.hasChildren?this.checkChildren().then(this.open):this.activatable&&!this.disabled&&(this.isActive=!this.isActive,this.treeview.updateActive(this.key,this.isActive),this.treeview.emitActive())}}}),s)},genChild(s,e){return this.$createElement(U,{key:r(s,this.itemKey),props:{activatable:this.activatable,activeClass:this.activeClass,item:s,selectable:this.selectable,selectedColor:this.selectedColor,color:this.color,disablePerNode:this.disablePerNode,expandIcon:this.expandIcon,indeterminateIcon:this.indeterminateIcon,offIcon:this.offIcon,onIcon:this.onIcon,loadingIcon:this.loadingIcon,itemKey:this.itemKey,itemText:this.itemText,itemDisabled:this.itemDisabled,itemChildren:this.itemChildren,loadChildren:this.loadChildren,transition:this.transition,openOnClick:this.openOnClick,rounded:this.rounded,shaped:this.shaped,level:this.level+1,selectionType:this.selectionType,parentIsDisabled:e},scopedSlots:this.$scopedSlots})},genChildrenWrapper(){if(!this.isOpen||!this.children)return null;const s=[this.children.map(e=>this.genChild(e,this.disabled))];return this.$createElement("div",{staticClass:"v-treeview-node__children"},s)},genTransition(){return this.$createElement(J,[this.genChildrenWrapper()])}},render(s){const e=[this.genNode()];return this.transition?e.push(this.genTransition()):e.push(this.genChildrenWrapper()),s("div",{staticClass:"v-treeview-node",class:{"v-treeview-node--leaf":!this.hasChildren,"v-treeview-node--click":this.openOnClick,"v-treeview-node--disabled":this.disabled,"v-treeview-node--rounded":this.rounded,"v-treeview-node--shaped":this.shaped,"v-treeview-node--selected":this.isSelected},attrs:{"aria-expanded":String(this.isOpen)}},e)}}),De=U;function Pe(s,e,t){return r(s,t).toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1}function R(s,e,t,i,n,a,o){if(s(e,t,n))return!0;const c=r(e,a);if(c){let l=!1;for(let p=0;p<c.length;p++)R(s,c[p],t,i,n,a,o)&&(l=!0);if(l)return!0}return o.add(r(e,i)),!1}const Fe=w(Z("treeview"),X).extend({name:"v-treeview",provide(){return{treeview:this}},props:{active:{type:Array,default:()=>[]},dense:Boolean,disabled:Boolean,filter:Function,hoverable:Boolean,items:{type:Array,default:()=>[]},multipleActive:Boolean,open:{type:Array,default:()=>[]},openAll:Boolean,returnObject:{type:Boolean,default:!1},search:String,value:{type:Array,default:()=>[]},...K},data:()=>({level:-1,activeCache:new Set,nodes:{},openCache:new Set,selectedCache:new Set}),computed:{excludedItems(){const s=new Set;if(!this.search)return s;for(let e=0;e<this.items.length;e++)R(this.filter||Pe,this.items[e],this.search,this.itemKey,this.itemText,this.itemChildren,s);return s}},watch:{items:{handler(){const s=Object.keys(this.nodes).map(n=>r(this.nodes[n].item,this.itemKey)),e=this.getKeys(this.items),t=ee(e,s);if(!t.length&&e.length<s.length)return;t.forEach(n=>delete this.nodes[n]);const i=[...this.selectedCache];this.selectedCache=new Set,this.activeCache=new Set,this.openCache=new Set,this.buildTree(this.items),A(i,[...this.selectedCache])||this.emitSelected()},deep:!0},active(s){this.handleNodeCacheWatcher(s,this.activeCache,this.updateActive,this.emitActive)},value(s){this.handleNodeCacheWatcher(s,this.selectedCache,this.updateSelected,this.emitSelected)},open(s){this.handleNodeCacheWatcher(s,this.openCache,this.updateOpen,this.emitOpen)}},created(){const s=e=>this.returnObject?r(e,this.itemKey):e;this.buildTree(this.items);for(const e of this.value.map(s))this.updateSelected(e,!0,!0);for(const e of this.active.map(s))this.updateActive(e,!0)},mounted(){(this.$slots.prepend||this.$slots.append)&&te("The prepend and append slots require a slot-scope attribute",this),this.openAll?this.updateAll(!0):(this.open.forEach(s=>this.updateOpen(this.returnObject?r(s,this.itemKey):s,!0)),this.emitOpen())},methods:{updateAll(s){Object.keys(this.nodes).forEach(e=>this.updateOpen(r(this.nodes[e].item,this.itemKey),s)),this.emitOpen()},getKeys(s,e=[]){for(let t=0;t<s.length;t++){const i=r(s[t],this.itemKey);e.push(i);const n=r(s[t],this.itemChildren);n&&e.push(...this.getKeys(n))}return e},buildTree(s,e=null){var t;for(let i=0;i<s.length;i++){const n=s[i],a=r(n,this.itemKey),o=(t=r(n,this.itemChildren))!==null&&t!==void 0?t:[],c=this.nodes.hasOwnProperty(a)?this.nodes[a]:{isSelected:!1,isIndeterminate:!1,isActive:!1,isOpen:!1,vnode:null},l={vnode:c.vnode,parent:e,children:o.map(p=>r(p,this.itemKey)),item:n};if(this.buildTree(o,a),this.selectionType!=="independent"&&e!==null&&!this.nodes.hasOwnProperty(a)&&this.nodes.hasOwnProperty(e)?l.isSelected=this.nodes[e].isSelected:(l.isSelected=c.isSelected,l.isIndeterminate=c.isIndeterminate),l.isActive=c.isActive,l.isOpen=c.isOpen,this.nodes[a]=l,o.length&&this.selectionType!=="independent"){const{isSelected:p,isIndeterminate:u}=this.calculateState(a,this.nodes);l.isSelected=p,l.isIndeterminate=u}this.nodes[a].isSelected&&(this.selectionType==="independent"||l.children.length===0)&&this.selectedCache.add(a),this.nodes[a].isActive&&this.activeCache.add(a),this.nodes[a].isOpen&&this.openCache.add(a),this.updateVnodeState(a)}},calculateState(s,e){const t=e[s].children,i=t.reduce((o,c)=>(o[0]+=+Boolean(e[c].isSelected),o[1]+=+Boolean(e[c].isIndeterminate),o),[0,0]),n=!!t.length&&i[0]===t.length,a=!n&&(i[0]>0||i[1]>0);return{isSelected:n,isIndeterminate:a}},emitOpen(){this.emitNodeCache("update:open",this.openCache)},emitSelected(){this.emitNodeCache("input",this.selectedCache)},emitActive(){this.emitNodeCache("update:active",this.activeCache)},emitNodeCache(s,e){this.$emit(s,this.returnObject?[...e].map(t=>this.nodes[t].item):[...e])},handleNodeCacheWatcher(s,e,t,i){s=this.returnObject?s.map(a=>r(a,this.itemKey)):s;const n=[...e];A(n,s)||(n.forEach(a=>t(a,!1)),s.forEach(a=>t(a,!0)),i())},getDescendants(s,e=[]){const t=this.nodes[s].children;e.push(...t);for(let i=0;i<t.length;i++)e=this.getDescendants(t[i],e);return e},getParents(s){let e=this.nodes[s].parent;const t=[];for(;e!==null;)t.push(e),e=this.nodes[e].parent;return t},register(s){const e=r(s.item,this.itemKey);this.nodes[e].vnode=s,this.updateVnodeState(e)},unregister(s){const e=r(s.item,this.itemKey);this.nodes[e]&&(this.nodes[e].vnode=null)},isParent(s){return this.nodes[s].children&&this.nodes[s].children.length},updateActive(s,e){if(!this.nodes.hasOwnProperty(s))return;this.multipleActive||this.activeCache.forEach(i=>{this.nodes[i].isActive=!1,this.updateVnodeState(i),this.activeCache.delete(i)});const t=this.nodes[s];!t||(e?this.activeCache.add(s):this.activeCache.delete(s),t.isActive=e,this.updateVnodeState(s))},updateSelected(s,e,t=!1){if(!this.nodes.hasOwnProperty(s))return;const i=new Map;if(this.selectionType!=="independent"){for(const a of this.getDescendants(s))(!r(this.nodes[a].item,this.itemDisabled)||t)&&(this.nodes[a].isSelected=e,this.nodes[a].isIndeterminate=!1,i.set(a,e));const n=this.calculateState(s,this.nodes);this.nodes[s].isSelected=e,this.nodes[s].isIndeterminate=n.isIndeterminate,i.set(s,e);for(const a of this.getParents(s)){const o=this.calculateState(a,this.nodes);this.nodes[a].isSelected=o.isSelected,this.nodes[a].isIndeterminate=o.isIndeterminate,i.set(a,o.isSelected)}}else this.nodes[s].isSelected=e,this.nodes[s].isIndeterminate=!1,i.set(s,e);for(const[n,a]of i.entries())this.updateVnodeState(n),!(this.selectionType==="leaf"&&this.isParent(n))&&(a===!0?this.selectedCache.add(n):this.selectedCache.delete(n))},updateOpen(s,e){if(!this.nodes.hasOwnProperty(s))return;const t=this.nodes[s],i=r(t.item,this.itemChildren);i&&!i.length&&t.vnode&&!t.vnode.hasLoaded?t.vnode.checkChildren().then(()=>this.updateOpen(s,e)):i&&i.length&&(t.isOpen=e,t.isOpen?this.openCache.add(s):this.openCache.delete(s),this.updateVnodeState(s))},updateVnodeState(s){const e=this.nodes[s];e&&e.vnode&&(e.vnode.isSelected=e.isSelected,e.vnode.isIndeterminate=e.isIndeterminate,e.vnode.isActive=e.isActive,e.vnode.isOpen=e.isOpen)},isExcluded(s){return!!this.search&&this.excludedItems.has(s)}},render(s){const e=this.items.length?this.items.filter(t=>!this.isExcluded(r(t,this.itemKey))).map(t=>De.options.methods.genChild.bind(this)(t,this.disabled||r(t,this.itemDisabled))):this.$slots.default;return s("div",{staticClass:"v-treeview",class:{"v-treeview--hoverable":this.hoverable,"v-treeview--dense":this.dense,...this.themeClasses}},e)}});const Ee={name:"TorrentTagsAndCategories",mixins:[C],props:{hash:String,torrent:Object},data:()=>({categories:[]}),computed:{...L(["getAvailableTags","getCategories"]),availableTags(){return this.getAvailableTags()},availableCategories(){return this.getCategories()},activeCategory(){return this.availableCategories.map(s=>s.name).indexOf(this.torrent.category)},activeTags(){const s=[],e=this.torrent.tags;return e&&e.length&&e.forEach(t=>{const i=this.availableTags.indexOf(t);i!==-1&&s.push(i)}),s}},created(){this.$store.commit("FETCH_CATEGORIES"),this.$store.commit("FETCH_TAGS")},methods:{addTag(s){return this.activeTags.includes(this.availableTags.indexOf(s))?this.deleteTag(s):d.addTorrentTag([this.hash],s)},deleteTag(s){d.removeTorrentTag([this.hash],s)},setCategory(s){return this.torrent.category===s.name?this.deleteCategory():d.setCategory([this.hash],s.name)},deleteCategory(){d.setCategory([this.hash],"")}}};var Ne=function(){var e=this,t=e._self._c;return t(m,{attrs:{flat:""}},[t(b,{staticClass:"ma-0 pa-0",attrs:{dense:""}},[t(T,{attrs:{cols:"12",md:"6"}},[t(O,[e._v(e._s(e.$t("modals.detail.pageTagsAndCategories.subHeaderTag")))]),t(E,{attrs:{value:e.activeTags,"active-class":"accent--text",multiple:""}},[e._l(e.availableTags,function(i,n){return[t(S,{key:i.title,attrs:{link:""},on:{click:function(a){return e.addTag(i)}}},[t(D,[t($,{domProps:{textContent:e._s(i)}})],1)],1),n<e.availableTags.length-1?t(P,{key:n}):e._e()]})],2)],1),t(T,{attrs:{cols:"12",md:"6"}},[t(O,[e._v(e._s(e.$t("modals.detail.pageTagsAndCategories.subHeaderCategories")))]),t(E,{attrs:{value:e.activeCategory,"active-class":"accent--text"}},[e._l(e.availableCategories,function(i,n){return[t(S,{key:i.title,attrs:{link:""},on:{click:function(a){return e.setCategory(i)}}},[t(D,[t($,{domProps:{textContent:e._s(i.name)}})],1)],1),n<e.availableCategories.length-1?t(P,{key:n}):e._e()]})],2)],1)],1)],1)},Le=[],Ve=v(Ee,Ne,Le,!1,null,"43cc7514",null,null);const W=Ve.exports,N=[{name:"max",icon:_e,value:7},{name:"high",icon:pe,value:6},{name:"normal",icon:ue,value:1},{name:"unwanted",icon:me,value:0}],Be={name:"Content",filters:{priority(s){if(s===4)return"normal";const e=N.find(t=>t.value===s);return e?e.name:"undefined"}},mixins:[C],props:{hash:String,isActive:Boolean},data(){return{inited:!1,opened:null,selected:[],treeData:null,priority_options:N,mdiFolderOpen:se,mdiFolder:ie,mdiFile:ne,mdiTrendingUp:ae,mdiPencil:re,mdiContentSave:oe,mdiClose:B}},computed:{fileTree(){return this.treeData?le(this.treeData):[]}},watch:{isActive(s){s&&(this.inited?this.getTorrentFiles():(this.initFiles(),this.inited=!0))},selected(s,e){this.changeFilePriorities(s,e)}},created(){},methods:{initFiles(){this.getTorrentFiles().then(()=>{this.opened=[],this.selected=this.treeData.filter(s=>s.priority!==0).map(s=>s.name)})},async getTorrentFiles(){const{data:s}=await d.getTorrentFiles(this.hash);s.forEach((e,t)=>{e.id=t,e.name=e.name.replace(".unwanted/","")}),this.treeData=s},async changeFilePriorities(s,e){if(s.length===e.length)return;const t=e.filter(n=>!s.includes(n)).map(n=>this.treeData.find(a=>a.name===n)).filter(n=>n.priority!==0).map(n=>n.id),i=s.filter(n=>!e.includes(n)).map(n=>this.treeData.find(a=>a.name===n)).filter(n=>n.priority===0).map(n=>n.id);t.length&&await d.setTorrentFilePriority(this.hash,t,0),i.length&&await d.setTorrentFilePriority(this.hash,i,1),(t.length||i.length)&&await this.getTorrentFiles()},toggleEditing(s){s.editing=!s.editing},edit(s){s.newName=s.name,this.toggleEditing(s)},renameFile(s){d.renameFile(this.hash,s.name,s.newName).catch(()=>I.$toast.error(this.$t("toast.renameFileFailed"))),s.name=s.newName,this.toggleEditing(s)},renameFolder(s){d.renameFolder(this.hash,s.name,s.newName).catch(()=>I.$toast.error(this.$t("toast.renameFolderFailed"))),s.name=s.newName,this.toggleEditing(s)},setFilePrio(s,e){d.setTorrentFilePriority(this.hash,[s],e).then(()=>this.initFiles())}}};var je=function(){var e=this,t=e._self._c;return t(m,{attrs:{flat:""}},[t(Fe,{attrs:{items:e.fileTree,open:e.opened,activatable:"",selectable:"","item-key":"fullName","open-all":""},on:{"update:open":function(i){e.opened=i}},scopedSlots:e._u([{key:"prepend",fn:function({item:i,open:n}){return[i.icon?t(h,[e._v(" "+e._s(i.icon)+" ")]):t(h,[e._v(" "+e._s(e.mdiFolderOpen)+" ")])]}},{key:"label",fn:function({item:i}){return[i.editing?e._e():t("span",[e._v(e._s(i.name))]),i.editing?t(de,{attrs:{autofocus:""},model:{value:i.newName,callback:function(n){e.$set(i,"newName",n)},expression:"item.newName"}}):e._e()]}},e.$vuetify.breakpoint.smAndDown?null:{key:"append",fn:function({item:i}){return[i.icon?t("div",[t("span",[e._v("["+e._s(i.size)+"]")]),t("span",{staticClass:"ml-4"},[e._v(e._s(i.progress)+"%")]),t("span",{staticClass:"ml-4"},[e._v("[ "+e._s(e._f("priority")(i.priority))+" ]")]),t(ce,{attrs:{"open-on-hover":"","offset-y":""},scopedSlots:e._u([{key:"activator",fn:function({on:n}){return[t(_,e._g({staticClass:"accent white--text elevation-0 px-4 ml-2",attrs:{fab:"","x-small":""}},n),[t(h,[e._v(e._s(e.mdiTrendingUp))])],1)]}}],null,!0)},[t(he,e._l(e.priority_options,function(n){return t(S,{key:n.value,attrs:{link:""},on:{click:function(a){return e.setFilePrio(i.id,n.value)}}},[t(h,[e._v(e._s(n.icon))]),t($,{staticClass:"caption"},[e._v(" "+e._s(n.name)+" ")])],1)}),1)],1),i.editing?e._e():t(_,{staticClass:"accent white--text elevation-0 px-4 ml-2",attrs:{fab:"","x-small":""},on:{click:function(n){return e.edit(i)}}},[t(h,[e._v(e._s(e.mdiPencil))])],1),i.editing?t(_,{staticClass:"accent white--text elevation-0 px-4 ml-2",attrs:{fab:"","x-small":""},on:{click:function(n){return e.renameFile(i)}}},[t(h,[e._v(e._s(e.mdiContentSave))])],1):e._e(),i.editing?t(_,{staticClass:"error white--text elevation-0 px-4 ml-2",attrs:{fab:"","x-small":""},on:{click:function(n){return e.toggleEditing(i)}}},[t(h,[e._v(e._s(e.mdiClose))])],1):e._e()],1):t("div",[t("span",{staticClass:"ml-4"},[e._v(e._s(i.children.length)+" Files")]),i.editing?e._e():t(_,{staticClass:"accent white--text elevation-0 px-4 ml-2",attrs:{fab:"","x-small":""},on:{click:function(n){return e.edit(i)}}},[t(h,[e._v(e._s(e.mdiPencil))])],1),i.editing?t(_,{staticClass:"accent white--text elevation-0 px-4 ml-2",attrs:{fab:"","x-small":""},on:{click:function(n){return e.renameFolder(i)}}},[t(h,[e._v(e._s(e.mdiContentSave))])],1):e._e(),i.editing?t(_,{staticClass:"error white--text elevation-0 px-4 ml-2",attrs:{fab:"","x-small":""},on:{click:function(n){return e.toggleEditing(i)}}},[t(h,[e._v(e._s(e.mdiClose))])],1):e._e()],1)]}}],null,!0),model:{value:e.selected,callback:function(i){e.selected=i},expression:"selected"}})],1)},Ke=[],Ue=v(Be,je,Ke,!1,null,null,null,null);const z=Ue.exports;const Re={name:"DetailPeers",mixins:[C],props:{hash:String,isActive:Boolean},data:()=>({refreshTimer:"",peersObj:null}),computed:{rid:{get(){return this.$store.state.rid},set(s){this.$store.state.rid=s}},peers(){return F.exports.map(this.peersObj,(s,e)=>F.exports.merge({},s,{key:e}))},headers(){return[{text:this.$i18n.t("modals.detail.pagePeers.ip"),value:"ip"},{text:this.$i18n.t("modals.detail.pagePeers.connection"),value:"connection"},{text:this.$i18n.t("modals.detail.pagePeers.flags"),value:"flags"},{text:this.$i18n.t("modals.detail.pagePeers.client"),value:"client"},{text:this.$i18n.t("modals.detail.pagePeers.progress"),value:"progress"},{text:this.$i18n.t("modals.detail.pagePeers.downloadSpeed"),value:"dl_speed"},{text:this.$i18n.t("modals.detail.pagePeers.downloaded"),value:"downloaded"},{text:this.$i18n.t("modals.detail.pagePeers.upSpeed"),value:"up_speed"},{text:this.$i18n.t("modals.detail.pagePeers.uploaded"),value:"uploaded"},{text:this.$i18n.t("modals.detail.pagePeers.relevance"),value:"relevance"},{text:this.$i18n.t("modals.detail.pagePeers.files"),value:"files"}]}},watch:{isActive(s){s?(this.getTorrentPeers(),this.refreshTimer=setInterval(function(){this.getTorrentPeers()}.bind(this),2e3)):clearTimeout(this.refreshTimer)}},created(){},beforeDestroy(){},methods:{codeToFlag(s){return ve(s)},isWindows(){return fe()},async getTorrentPeers(){const{data:s}=await d.getTorrentPeers(this.hash,this.rid+1||void 0);this.rid=s.rid,this.peersObj=s.peers}}};var We=function(){var e=this,t=e._self._c;return t(m,{attrs:{flat:""}},[e.peers?t(j,{attrs:{dense:"",headers:e.headers,items:e.peers,"items-per-page":-1,"hide-default-footer":!0,"mobile-breakpoint":"0"},scopedSlots:e._u([{key:"item",fn:function(i){return[t("tr",[t("td",{staticClass:"ip"},[i.item.country_code?[e.isWindows?t("img",{staticClass:"country-flag",attrs:{title:i.item.country,alt:e.codeToFlag(i.item.country_code).char,src:e.codeToFlag(i.item.country_code).url}}):[e._v(" "+e._s(e.codeToFlag(i.item.country_code).char)+" ")]]:e._e(),e._v(" "+e._s(i.item.ip)+" "),t("span",{staticClass:"grey--text"},[e._v(":"+e._s(i.item.port))])],2),t("td",[e._v(e._s(i.item.connection))]),t("td",{attrs:{title:i.item.flags_desc}},[e._v(" "+e._s(i.item.flags)+" ")]),t("td",[e._v(e._s(i.item.client))]),t("td",[e._v(e._s(e._f("progress")(i.item.progress)))]),t("td",[e._v(e._s(e._f("networkSpeed")(i.item.dl_speed)))]),t("td",[e._v(e._s(e._f("networkSize")(i.item.downloaded)))]),t("td",[e._v(e._s(e._f("networkSpeed")(i.item.up_speed)))]),t("td",[e._v(e._s(e._f("networkSize")(i.item.uploaded)))]),t("td",[e._v(e._s(e._f("progress")(i.item.relevance)))]),t("td",[e._v(e._s(i.item.files))])])]}}],null,!1,1377702202)}):e._e()],1)},ze=[],qe=v(Re,We,ze,!1,null,"0aa74558",null,null);const q=qe.exports;const Ge={name:"Trackers",filters:{formatTrackerStatus(s){return["Disabled","Not contacted","Working","Updating","Not working"][s]},formatTrackerNum(s){return s===-1?"N/A":s.toString()}},mixins:[C],props:{hash:String,isActive:Boolean},data:()=>({trackerDialog:!1,tempTrackers:[],newTrackers:"",selectedTrackers:[]}),computed:{trackers(){return this.tempTrackers.map(s=>({...s,isSelectable:typeof s.tier=="number"}))},headers(){return[{text:"#",value:"tier"},{text:this.$i18n.t("modals.detail.pageTrackers.url"),value:"url"},{text:this.$i18n.t("modals.detail.pageTrackers.status"),value:"status"},{text:this.$i18n.t("modals.detail.pageTrackers.peers"),value:"num_peers"},{text:this.$i18n.t("modals.detail.pageTrackers.seeds"),value:"num_seeds"},{text:this.$i18n.t("modals.detail.pageTrackers.leeches"),value:"num_leeches"},{text:this.$i18n.t("modals.detail.pageTrackers.downloaded"),value:"num_downloaded"},{text:this.$i18n.t("modals.detail.pageTrackers.message"),value:"msg"}]}},watch:{isActive(s){s&&this.getTorrentTrackers()}},created(){this.getTorrentTrackers()},methods:{async getTorrentTrackers(){const{data:s}=await d.getTorrentTrackers(this.hash);this.tempTrackers=s},async addTrackers(){if(!this.newTrackers.length)return this.trackerDialog=!1;d.addTorrenTrackers(this.hash,this.newTrackers),this.newTrackers="",await this.getTorrentTrackers(),this.trackerDialog=!1},closeAddTrackers(){this.newTrackers="",this.trackerDialog=!1},async DeleteTrackers(){!this.selectedTrackers.length||(d.removeTorrentTrackers(this.hash,this.selectedTrackers.map(s=>s.url)),this.selectedTrackers=[],await this.getTorrentTrackers())}}};var Me=function(){var e=this,t=e._self._c;return t(m,{attrs:{flat:""}},[t(k,{staticClass:"pa-0"},[e.trackers?t(j,{attrs:{dense:"","show-select":"",headers:e.headers,items:e.trackers,"items-per-page":-1,"item-key":"url","mobile-breakpoint":"0"},scopedSlots:e._u([{key:"body",fn:function({items:i}){return[t("tbody",e._l(i,function(n){return t("tr",{key:n.url},[t("td",[typeof n.tier=="number"?t(Ie,{staticClass:"pa-0 ma-0",attrs:{value:n,"hide-details":"",color:"accent"},model:{value:e.selectedTrackers,callback:function(a){e.selectedTrackers=a},expression:"selectedTrackers"}}):e._e()],1),t("td",[e._v(e._s(n.tier))]),t("td",[e._v(e._s(n.url))]),t("td",[e._v(e._s(e._f("formatTrackerStatus")(n.status)))]),t("td",[e._v(e._s(e._f("formatTrackerNum")(n.num_peers)))]),t("td",[e._v(e._s(e._f("formatTrackerNum")(n.num_seeds)))]),t("td",[e._v(e._s(e._f("formatTrackerNum")(n.num_leeches)))]),t("td",[e._v(e._s(e._f("formatTrackerNum")(n.num_downloaded)))]),t("td",[e._v(e._s(n.msg))])])}),0)]}}],null,!1,2880887245),model:{value:e.selectedTrackers,callback:function(i){e.selectedTrackers=i},expression:"selectedTrackers"}}):e._e()],1),t(x,{staticClass:"justify-center"},[t(_,{staticClass:"error white--text elevation-0 px-4 mx-2",on:{click:e.DeleteTrackers}},[e._v(" Delete ")]),t(we,{attrs:{"content-class":"rounded-form",persistent:"","max-width":"290"},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:n}){return[t(_,e._g(e._b({staticClass:"accent white--text elevation-0 px-4 mx-2"},"v-btn",n,!1),i),[e._v(" Add ")])]}}]),model:{value:e.trackerDialog,callback:function(i){e.trackerDialog=i},expression:"trackerDialog"}},[t(m,[t(ge,{staticClass:"justify-center"},[t("h3",[e._v("Add Trackers")])]),t(k,[t(Ae,{attrs:{label:"Trackers",rows:"1",required:"",autofocus:"","auto-grow":"",clearable:"",hint:"One link per line"},model:{value:e.newTrackers,callback:function(i){e.newTrackers=i},expression:"newTrackers"}})],1),t(x,[t(Ce),t(_,{attrs:{color:"red darken-1",text:""},on:{click:e.closeAddTrackers}},[e._v(" Cancel ")]),t(_,{attrs:{color:"green darken-1",text:""},on:{click:e.addTrackers}},[e._v(" Add ")])],1)],1)],1)],1)],1)},He=[],Qe=v(Ge,Me,He,!1,null,"85796fea",null,null);const G=Qe.exports;const Ye={name:"Info",mixins:[C],props:{hash:String,torrent:Object},data(){return{commonStyle:"caption",createdBy:null,comment:null}},mounted(){this.getTorrentProperties(),this.renderTorrentPieceStates()},methods:{async getTorrentProperties(){const s=await d.getTorrentProperties(this.hash);this.createdBy=s.created_by||null,this.comment=s.comment||null},async renderTorrentPieceStates(){const s=document.querySelector("#pieceStates canvas"),{data:e}=await d.getTorrentFiles(this.hash),{data:t}=await d.getTorrentPieceStates(this.hash);if(t){s.width=t.length;const i=s.getContext("2d");i.clearRect(0,0,s.width,s.height);let n="",a=1;for(let o=0;o<t.length;++o){const c=t[o];let l="";if(c===1)l=this.$vuetify.theme.currentTheme["torrent-downloading"];else if(c===2)l=this.$vuetify.theme.currentTheme["torrent-done"];else{const p=e.filter(u=>u.priority!==0).map(u=>u.piece_range);for(const[u,H]of p)if(o>u&&o<H){l=this.$vuetify.theme.currentTheme["torrent-paused"];break}}if(l===n){++a;continue}n!==""&&(i.fillStyle=n,i.fillRect(o-a,0,a,s.height)),a=1,n=l}n!==""&&(i.fillStyle=n,i.fillRect(t.length-a,0,a,s.height))}},stringContainsUrl(s){return Te(s)},splitString(s){return ye(s)}}};var Je=function(){var e=this,t=e._self._c;return t(m,{attrs:{flat:""}},[t(xe,[t("tbody",[t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.torrentTitle"))+" ")]),t("td",[e._v(" "+e._s(e.torrent.name)+" ")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.pieceStates"))+" ")]),t("td",{staticClass:"d-flex",attrs:{id:"pieceStates"}},[t("span",{staticClass:"mr-2 align-center d-flex"},[e._v(" "+e._s(e.torrent.progress)+"% ")]),t("canvas",{attrs:{width:"0",height:"1"}})])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e._f("titleCase")(e.$t("torrent.directory")))+" ")]),t("td",[e._v(" "+e._s(e.torrent.savePath)+" ")])]),t("tr",{staticStyle:{"margin-top":"10px !important"}},[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.hash"))+" ")]),t("td",[e._v(" "+e._s(e.torrent.hash)+" ")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e._f("titleCase")(e.$t("torrent.size")))+" ")]),t("td",[e._v(" "+e._s(e._f("getDataValue")(e.torrent.size))+" "+e._s(e._f("getDataUnit")(e.torrent.size,1))+" ")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e._f("titleCase")(e.$t("torrent.timeActive")))+" ")]),t("td",[e._v(" "+e._s(e.torrent.time_active)+" "),e.torrent.seeding_time?t("span",[e._v(e._s(`(${e.$t("torrent.seededFor")} ${e.torrent.seeding_time})`))]):e._e()])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e._f("titleCase")(e.$t("torrent.downloaded")))+" ")]),t("td",[e._v(" "+e._s(e._f("getDataValue")(e.torrent.dloaded))+" "+e._s(e._f("getDataUnit")(e.torrent.dloaded,1))+" ")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e._f("titleCase")(e.$t("torrent.uploaded")))+" ")]),t("td",[e._v(" "+e._s(e._f("getDataValue")(e.torrent.uploaded))+" "+e._s(e._f("getDataUnit")(e.torrent.uploaded,1))+" ")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.ratio"))+" ")]),t("td",[e._v(" "+e._s(e.torrent.ratio)+" ")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.downloadSpeed"))+" ")]),t("td",[e._v(" "+e._s(e._f("getDataValue")(e.torrent.dlspeed))+" "+e._s(e._f("getDataUnit")(e.torrent.dlspeed,1))+"/s ")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.uploadSpeed"))+" ")]),t("td",[e._v(" "+e._s(e._f("getDataValue")(e.torrent.upspeed))+" "+e._s(e._f("getDataUnit")(e.torrent.upspeed,1))+"/s ")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.eta"))+" ")]),t("td",[e._v(" "+e._s(e.torrent.eta)+" ")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.peers"))+" ")]),t("td",[e._v(" "+e._s(e.torrent.num_leechs)),t("span",{class:e.commonStyle},[e._v("/"+e._s(e.torrent.available_peers))])])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.seeds"))+" ")]),t("td",[e._v(" "+e._s(e.torrent.num_seeds)),t("span",{class:e.commonStyle},[e._v("/"+e._s(e.torrent.available_seeds))])])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e._f("titleCase")(e.$t("torrent.added")))+" ")]),t("td",[e._v(" "+e._s(e.torrent.added_on)+" ")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.status"))+" ")]),t("td",[t(be,{class:`${e.torrent.state.toLowerCase()} white--text caption`,attrs:{small:""}},[e._v(" "+e._s(e.torrent.state)+" ")])],1)]),e.torrent.tracker?t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.trackers"))+" ")]),t("td",e._l(e.splitString(e.torrent.tracker),function(i){return t("span",{key:i},[e.stringContainsUrl(i)?t("a",{attrs:{_target:"blank",href:i}},[e._v(e._s(i))]):t("span",[e._v(e._s(i))])])}),0)]):e._e(),e.createdBy?t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.createdBy"))+" ")]),t("td",e._l(e.splitString(e.createdBy),function(i){return t("span",{key:i},[e.stringContainsUrl(i)?t("a",{attrs:{_target:"blank",href:i}},[e._v(e._s(i))]):t("span",[e._v(e._s(i))])])}),0)]):e._e(),e.comment?t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e._f("titleCase")(e.$t("torrent.comments")))+" ")]),t("td",e._l(e.splitString(e.comment),function(i){return t("span",{key:i},[e.stringContainsUrl(i)?t("a",{attrs:{_target:"blank",href:i}},[e._v(e._s(i))]):t("span",[e._v(e._s(i))])])}),0)]):e._e(),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.firstLastPiecePriority"))+" ")]),t("td",[e._v(" "+e._s(e.torrent.f_l_piece_prio)+" ")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.sequentialDownload"))+" ")]),t("td",[e._v(" "+e._s(e.torrent.seq_dl)+" ")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.autoTMM"))+" ")]),t("td",[e._v(" "+e._s(e.torrent.auto_tmm)+" ")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.shareRatioLimit"))+" ")]),t("td",[e._v(" "+e._s(e._f("limitToValue")(e.torrent.ratio_limit))+" ")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.shareTimeLimit"))+" ")]),t("td",[e._v(" "+e._s(e._f("limitToValue")(e.torrent.ratio_time_limit))+" ")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.downloadLimit"))+" ")]),e.torrent.dl_limit>0?t("td",[e._v(e._s(e._f("getDataValue")(e.torrent.dl_limit))+" "+e._s(e._f("getDataUnit")(e.torrent.dl_limit))),t("span",[e._v("/s ")])]):t("td",[e._v("\u221E")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e.$t("modals.detail.pageInfo.uploadLimit"))+" ")]),e.torrent.up_limit>0?t("td",[e._v(e._s(e._f("getDataValue")(e.torrent.up_limit))+" "+e._s(e._f("getDataUnit")(e.torrent.up_limit))),t("span",[e._v("/s ")])]):t("td",[e._v("\u221E")])]),t("tr",[t("td",{class:e.commonStyle},[e._v(" "+e._s(e._f("titleCase")(e.$t("torrent.availability")))+" ")]),t("td",[e._v(" "+e._s(e.torrent.availability)+" ")])])])])],1)},Xe=[],Ze=v(Ye,Je,Xe,!1,null,"7cd4b235",null,null);const M=Ze.exports,et={name:"TorrentDetail",components:{Content:z,Info:M,DetailPeers:q,Trackers:G,TorrentTagsAndCategories:W},data(){return{tab:null,items:[{tab:"Info"},{tab:"Content"}],peers:[],mdiClose:B}},computed:{...L(["getTorrent"]),torrent(){return this.getTorrent(this.hash)},hash(){return this.$route.params.hash}},created(){this.$store.dispatch("INIT_INTERVALS")},destroyed(){this.$store.commit("REMOVE_INTERVALS")},methods:{close(){this.$router.back()}}};var tt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"px-1 px-sm-5 background noselect"},[t(b,{staticClass:"grey--text",attrs:{"no-gutters":"",align:"center",justify:"center"}},[t(T,[t("h1",{staticClass:"subtitle-1 ml-2",staticStyle:{"font-size":"1.6em !important"}},[e._v(" "+e._s(e._f("titleCase")(e.$t("modals.detail.title")))+" ")])]),t(T,{staticClass:"align-center justify-center"},[t(x,{staticClass:"justify-end"},[t(_,{attrs:{small:"",elevation:"0"},on:{click:e.close}},[t(h,[e._v(e._s(e.mdiClose))])],1)],1)],1)],1),t(b,{staticClass:"ma-0 pa-0"},[t(Se,{attrs:{"align-with-title":"","show-arrows":"","background-color":"primary"},model:{value:e.tab,callback:function(i){e.tab=i},expression:"tab"}},[t($e,{attrs:{color:"white"}}),t(f,{staticClass:"white--text",attrs:{href:"#info"}},[t("h4",[e._v(e._s(e.$t("modals.detail.tabTitleInfo")))])]),t(f,{staticClass:"white--text",attrs:{href:"#trackers"}},[t("h4",[e._v(e._s(e.$t("modals.detail.tabTitleTrackers")))])]),t(f,{staticClass:"white--text",attrs:{href:"#peers"}},[t("h4",[e._v(e._s(e.$t("modals.detail.tabTitlePeers")))])]),t(f,{staticClass:"white--text",attrs:{href:"#content"}},[t("h4",[e._v(e._s(e.$t("modals.detail.tabTitleContent")))])]),t(f,{staticClass:"white--text",attrs:{href:"#tagsAndCategories"}},[t("h4",[e._v(e._s(e.$t("modals.detail.tabTitleTagsCategories")))])])],1),t(k,{staticClass:"pa-0"},[t(ke,{attrs:{touchless:""},model:{value:e.tab,callback:function(i){e.tab=i},expression:"tab"}},[t(g,{attrs:{eager:"",value:"info"}},[e.torrent?t(M,{attrs:{torrent:e.torrent,hash:e.hash}}):e._e()],1),t(g,{attrs:{eager:"",value:"trackers"}},[t(G,{attrs:{"is-active":e.tab==="trackers",hash:e.hash}})],1),t(g,{attrs:{eager:"",value:"peers"}},[t(q,{attrs:{"is-active":e.tab==="peers",hash:e.hash}})],1),t(g,{attrs:{eager:"",value:"content"}},[t(z,{attrs:{"is-active":e.tab==="content",hash:e.hash}})],1),t(g,{attrs:{eager:"",value:"tagsAndCategories"}},[e.torrent?t(W,{attrs:{torrent:e.torrent,"is-active":e.tab==="tagsAndCategories",hash:e.hash}}):e._e()],1)],1)],1)],1)],1)},st=[],it=v(et,tt,st,!1,null,null,null,null);const pt=it.exports;export{pt as default};
