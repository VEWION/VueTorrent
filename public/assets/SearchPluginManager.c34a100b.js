import{d as _,a as h}from"./vue.7fbf5199.js";import{F as m}from"./FullScreenModal.adc180e8.js";import{M as p}from"./Modal.1c0dbfc6.js";import{a9 as f,Q as n,s as P,t as o,V as r,v,D as i,x as s,z as u,a as x,E as c,y as b,a3 as k}from"./index.f23ec703.js";import{_ as d}from"./VDialog.b9d93995.js";import{_ as y}from"./VDataTable.f4a08132.js";const w=_({name:"SearchPluginManager",mixins:[p,m],data(){return{headers:[{text:"Name",value:"fullName"},{text:"Version",value:"version"},{text:"URL",value:"url"},{text:"Actions",value:"actions"}],enabledPlugins:[],loading:!1,installDialog:!1,installInput:"",mdiDelete:f}},computed:{...h(["searchPlugins"])},mounted(){document.addEventListener("keydown",this.handleKeyboardShortcut),this.loading=!0,this.updatePluginList(),this.loading=!1},beforeDestroy(){document.removeEventListener("keydown",this.handleKeyboardShortcut)},methods:{async updatePluginList(){await this.$store.dispatch("FETCH_SEARCH_PLUGINS"),this.enabledPlugins=this.searchPlugins.filter(e=>e.enabled)},async onTogglePlugin(e){this.loading=!0,await n.enableSearchPlugin([e.item.name],e.value),this.loading=!1},async onToggleAllPlugins(e){this.loading=!0,await n.enableSearchPlugin(e.items.map(a=>a.name),e.value),this.loading=!1},async installNewPlugin(){this.loading=!0,this.closeInstallDialog(),await n.installSearchPlugin([this.installInput]),this.installInput="",await this.updatePluginList(),this.loading=!1},async checkForPluginUpdates(){this.loading=!0,await n.updateSearchPlugins(),await this.updatePluginList(),this.loading=!1},async uninstallPlugin(e){this.loading=!0,await n.uninstallSearchPlugin([e.name]),await this.updatePluginList(),this.loading=!1},close(){this.dialog=!1},closeInstallDialog(){this.installDialog=!1},handleKeyboardShortcut(e){e.key==="Escape"&&this.close()}}});var S=function(){var a=this,t=a._self._c;return a._self._setupProxy,t(d,{attrs:{scrollable:"",width:a.dialogWidth,fullscreen:a.phoneLayout},model:{value:a.dialog,callback:function(l){a.dialog=l},expression:"dialog"}},[t(o,[t(r,{staticClass:"pa-0"},[t(v,{staticClass:"ma-4 primarytext--text"},[t("h3",[a._v(a._s(a.$t("modals.searchPluginManager.title")))])]),t(i),t(d,{attrs:{"max-width":"500px"},scopedSlots:a._u([{key:"activator",fn:function({on:l,attrs:g}){return[t(s,a._g({staticClass:"primary white--text elevation-0 px-4 ma-4"},l),[a._v("Install")])]}}]),model:{value:a.installDialog,callback:function(l){a.installDialog=l},expression:"installDialog"}},[t(o,[t(r,[t("h5",[a._v(a._s(a.$t("modals.searchPluginManager.install.title")))])]),t(u,[t(x,{attrs:{label:a.$t("modals.searchPluginManager.install.label"),required:""},model:{value:a.installInput,callback:function(l){a.installInput=l},expression:"installInput"}})],1),t(c,[t(i),t(s,{attrs:{color:"accent darken-1",text:""},on:{click:a.closeInstallDialog}},[a._v(a._s(a.$t("cancel")))]),t(s,{attrs:{color:"accent darken-1",text:""},on:{click:a.installNewPlugin}},[a._v(a._s(a.$t("ok")))])],1)],1)],1)],1),t(u,[t(y,{staticStyle:{width:"100%"},attrs:{"item-key":"name",headers:a.headers,items:a.searchPlugins,"disable-pagination":"","hide-default-footer":"","show-select":"","sort-by":"name",loading:a.loading},on:{"item-selected":a.onTogglePlugin,"toggle-select-all":a.onToggleAllPlugins},scopedSlots:a._u([{key:"item.actions",fn:function({item:l}){return[t(b,{attrs:{color:"red",small:""},on:{click:function(g){return a.uninstallPlugin(l)}}},[a._v(" "+a._s(a.mdiDelete)+" ")])]}}]),model:{value:a.enabledPlugins,callback:function(l){a.enabledPlugins=l},expression:"enabledPlugins"}})],1),t(k),t(c,[t(i),t(s,{staticClass:"white--text elevation-0 px-4",on:{click:a.checkForPluginUpdates}},[a._v(" "+a._s(a.$t("modals.searchPluginManager.checkForUpdates"))+" ")]),t(s,{staticClass:"accent white--text elevation-0 px-4",on:{click:a.close}},[a._v(" "+a._s(a.$t("close"))+" ")])],1)],1)],1)},C=[],D=P(w,S,C,!1,null,null,null,null);const E=D.exports;export{E as default};
